<!DOCTYPE html>
<html lang="tl">
<head>
  <meta charset="UTF-8">
  <title>Module 1: Isyung Pangkapaligiran</title>
  <link rel="stylesheet" href="../css/style.css">
  <style>
    main {
      padding: 2rem;
      max-width: 900px;
      margin: auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    h1, h2 {
      color: #1565c0;
      margin-bottom: 1rem;
    }

    section {
      margin-bottom: 2rem;
    }

    .question {
      margin: 1.5rem 0;
    }

    .question p {
      font-weight: bold;
      margin-bottom: 0.5rem;
    }

    .question label {
      display: block;
      margin: 4px 0;
    }

    #submitQuiz {
      margin-top: 1rem;
      padding: 10px 20px;
      background-color: #1565c0;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    #quizResult {
      margin-top: 1rem;
      font-weight: bold;
    }
  </style>
</head>
<body class="dashboard-body">
  <main>
    <h1>Module 1: Isyung Pangkapaligiran</h1>

    <section>
      <h2>Natural Disaster</h2>
      <p>Ang mga natural disaster ay mga kalamidad na dulot ng pagbabago sa normal na estado ng kalikasan.</p>
      <ul>
        <li><strong>Bagyo</strong> – Malaking unos na may dalang malalakas na hangin at ulan. Ang "mata ng bagyo" ay ang kalmadong bahagi nito.</li>
        <li><strong>Baha</strong> – Pagtaas ng tubig dulot ng walang tigil na pag-ulan. Mas lumalala dahil sa baradong daluyan ng tubig.</li>
        <li><strong>Lindol</strong> – Biglaang pag-uga ng lupa dulot ng paggalaw ng mga batong nasa ilalim ng lupa.</li>
        <li><strong>Pagputok ng Bulkan</strong> – Paglabas ng lava at abo mula sa bunganga ng bulkan.</li>
        <li><strong>Pagguho ng Lupa</strong> – Landslide na dulot ng ulan o lindol. Mabilis at kadalasang walang babala.</li>
        <li><strong>Storm Surge</strong> – Di-pangkaraniwang pagtaas ng tubig sa dalampasigan habang may bagyo.</li>
        <li><strong>Tsunami</strong> – Serye ng malalaking alon dulot ng lindol o pagsabog sa ilalim ng dagat.</li>
      </ul>
    </section>

    <section>
      <h2>Climate Change</h2>
      <p>Ayon sa Intergovernmental Panel on Climate Change (2001), ito ay makabuluhang pagbabago sa klima na maaaring natural o dulot ng tao. Isa sa mga dahilan ay ang global warming dahil sa carbon dioxide mula sa usok ng pabrika, industriya, at pagsusunog ng kagubatan.</p>
    </section>

    <section>
      <h2>Mga Dahilan ng Deforestation</h2>
      <ul>
        <li><strong>Illegal Logging</strong> – Walang habas na pagputol ng puno. Nagdudulot ng pagbaha, soil erosion, at pagkawala ng tahanan ng hayop.</li>
        <li><strong>Migration</strong> – Paglipat ng tao sa kagubatan na nagsasagawa ng kaingin, na sumisira sa sustansya ng lupa.</li>
        <li><strong>Mabilis na Pagtaas ng Populasyon</strong> – Tumataas ang demand kaya ginagawang plantasyon o gusali ang kagubatan.</li>
        <li><strong>Fuel Wood Harvesting</strong> – Paggamit ng puno bilang panggatong tulad ng paggawa ng uling.</li>
        <li><strong>Ilegal na Pagmimina</strong> – Pagputol ng puno para sa operasyon ng minahan. Nagdudulot din ito ng polusyon sa kemikal.</li>
      </ul>
    </section>

    <section>
      <h2> Pagninilay</h2>
      <p>Sa iyong palagay? Paano natin mapapangalagaan ang ating kalikasan at maiwasan ang mga isyung pangkapaligiran? </p>

    </section>

    <section>
      <h2>Quiz: Isyung Pangkapaligiran</h2>
      <form id="quizForm">
        <div class="question">
          <p>1. Ano ang tawag sa gitnang kalmadong bahagi ng bagyo?</p>
          <label><input type="radio" name="q1" value="a"> Bagwis</label>
          <label><input type="radio" name="q1" value="b"> Ulap</label>
          <label><input type="radio" name="q1" value="c"> Mata ng Bagyo</label>
          <label><input type="radio" name="q1" value="d"> Buhawi</label>
        </div>

        <div class="question">
          <p>2. Anong uri ng natural disaster ang nangyayari kapag may lindol sa ilalim ng dagat?</p>
          <label><input type="radio" name="q2" value="a"> Baha</label>
          <label><input type="radio" name="q2" value="b"> Storm Surge</label>
          <label><input type="radio" name="q2" value="c"> Tsunami</label>
          <label><input type="radio" name="q2" value="d"> Pagguho ng lupa</label>
        </div>

        <div class="question">
          <p>3. Alin sa mga sumusunod ang hindi direktang sanhi ng climate change?</p>
          <label><input type="radio" name="q3" value="a"> Illegal Logging</label>
          <label><input type="radio" name="q3" value="b"> Global Warming</label>
          <label><input type="radio" name="q3" value="c"> Carbon Dioxide Emission</label>
          <label><input type="radio" name="q3" value="d"> Pag-inom ng tubig</label>
        </div>

        <div class="question">
          <p>4. Ano ang epekto ng migration sa kagubatan?</p>
          <label><input type="radio" name="q4" value="a"> Pagdami ng ibon</label>
          <label><input type="radio" name="q4" value="b"> Kaingin at pagkakalbo ng kagubatan</label>
          <label><input type="radio" name="q4" value="c"> Paglaki ng puno</label>
          <label><input type="radio" name="q4" value="d"> Paglamig ng klima</label>
        </div>

        <div class="question">
          <p>5. Ano ang pangunahing dahilan ng pagputol ng puno sa fuelwood harvesting?</p>
          <label><input type="radio" name="q5" value="a"> Pagpapaganda ng kagubatan</label>
          <label><input type="radio" name="q5" value="b"> Paggamit bilang uling o panggatong</label>
          <label><input type="radio" name="q5" value="c"> Pagtayo ng paaralan</label>
          <label><input type="radio" name="q5" value="d"> Pagsasaka</label>
        </div>

        <div class="question">
          <p>6. Ano ang tawag sa pagtaas ng tubig sa baybayin habang may bagyo?</p>
          <label><input type="radio" name="q6" value="a"> Daloy ng Ilog</label>
          <label><input type="radio" name="q6" value="b"> Storm Surge</label>
          <label><input type="radio" name="q6" value="c"> Alon</label>
          <label><input type="radio" name="q6" value="d"> Baha</label>
        </div>

        <div class="question">
          <p>7. Ano ang pangunahing sanhi ng pagguho ng lupa?</p>
          <label><input type="radio" name="q7" value="a"> Pag-ulan at lindol</label>
          <label><input type="radio" name="q7" value="b"> Init ng panahon</label>
          <label><input type="radio" name="q7" value="c"> Pagbaha</label>
          <label><input type="radio" name="q7" value="d"> Hanging habagat</label>
        </div>

        <div class="question">
          <p>8. Alin sa mga sumusunod ang nagdudulot ng mataas na carbon dioxide?</p>
          <label><input type="radio" name="q8" value="a"> Pag-ulan</label>
          <label><input type="radio" name="q8" value="b"> Paglilinis ng dagat</label>
          <label><input type="radio" name="q8" value="c"> Usok mula sa pabrika at industriya</label>
          <label><input type="radio" name="q8" value="d"> Pagdidilig ng halaman</label>
        </div>

        <div class="question">
          <p>9. Ano ang tawag sa uri ng pagsasaka na sumisira sa kagubatan?</p>
          <label><input type="radio" name="q9" value="a"> Kaingin</label>
          <label><input type="radio" name="q9" value="b"> Hydroponics</label>
          <label><input type="radio" name="q9" value="c"> Patubig</label>
          <label><input type="radio" name="q9" value="d"> Pagtatanim ng palay</label>
        </div>

        <div class="question">
          <p>10. Saan matatagpuan ang karamihan sa mga proyekto ng pagmimina sa Pilipinas?</p>
          <label><input type="radio" name="q10" value="a"> Maynila at Cebu</label>
          <label><input type="radio" name="q10" value="b"> Palawan, Sierra Madre, at Mindoro</label>
          <label><input type="radio" name="q10" value="c"> Laguna at Batangas</label>
          <label><input type="radio" name="q10" value="d"> Bukid sa urban area</label>
        </div>

        <button type="submit" id="submitQuiz">Submit Answers</button>
        <div id="quizResult"></div>
      </form>
    </section>
  </main>

  <script>
    document.getElementById("quizForm").addEventListener("submit", async function (e) {
      e.preventDefault();

      const correctAnswers = {
        q1: "c",
        q2: "c",
        q3: "d",
        q4: "b",
        q5: "b",
        q6: "b",
        q7: "a",
        q8: "c",
        q9: "a",
        q10: "b"
      };

      let score = 0;

      for (let key in correctAnswers) {
        const selected = document.querySelector(`input[name="${key}"]:checked`);
        if (selected && selected.value === correctAnswers[key]) {
          score++;
        }
      }

      const passed = score >= 8;
      const studentLRN = localStorage.getItem("studentLRN");

      if (!studentLRN) {
        alert("Missing LRN. Please log in again.");
        return;
      }

      try {
        const res = await fetch("/update-progress", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            lrn: studentLRN,
            module: "module1",
            score: {
              passed,
              score
            }
          })
        });

        const result = await res.json();

        if (result.success) {
          const resultDiv = document.getElementById("quizResult");
          resultDiv.innerHTML = `✅ You got ${score}/10. ${passed ? "You passed!" : "You need at least 8/10 to pass."}`;
          if (passed) {
            setTimeout(() => window.location.href = "dashboard.html", 2000);
          }
        } else {
          alert("⚠️ Error: " + (result.error || "Unknown error"));
        }
      } catch (err) {
        console.error("Error updating progress:", err);
        alert("⚠️ Server error.");
      }
    });

    // Soft warning before leaving
    window.onbeforeunload = function () {
      return "⚠️ Are you sure you want to leave? Your progress might be lost.";
    };

    // Disable warning after submission
    document.getElementById("quizForm").addEventListener("submit", function () {
      window.onbeforeunload = null;
    });
  </script>
</body>
</html>
